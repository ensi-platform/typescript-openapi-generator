CustomerReadonlyProperties:
  type: object
  properties:
    id:
      type: integer
      description: Идентификатор покупателя
      example: 1
    avatar:
      type: string
      description: Ссылка на аватар
      nullable: true
    delete_request:
      type: string
      format: date-time
      description: Дата и время запроса на удаление персональных данных
      example: 2021-06-11T11:27:10.000000Z
      nullable: true
    created_at:
      type: string
      format: date-time
      description: Дата создания
      example: 2020-12-17T21:24:28.000000Z
    updated_at:
      type: string
      format: date-time
      description: Дата обновления
      example: 2020-12-17T21:24:28.000000Z
  required:
    - id
    - avatar
    - delete_request
    - created_at
    - updated_at
CustomerFillableProperties:
  type: object
  properties:
    user_id:
      type: integer
      description: Идентификатор пользователя
      example: 42
      nullable: true
    status_id:
      type: integer
      description: Идентификатор статуса пользователя
      example: 2
      nullable: true
    manager_id:
      type: integer
      description: Идентификатор менеджера
      example: 4
      nullable: true
    yandex_metric_id:
      type: string
      description: Идентификатор пользователя в YandexMetric
      example: C001
      nullable: true
    google_analytics_id:
      type: string
      description: Идентификатор пользователя в GoogleAnalytics
      example: G001
      nullable: true
    active:
      type: boolean
      description: Активность пользователя
      example: true
    email:
      type: string
      description: Email
      example: test@mail.ru
      nullable: true
    phone:
      type: string
      description: Телефон
      example: "+79191000000"
    last_name:
      type: string
      description: Фамилия
      example: Иванов
      nullable: true
    first_name:
      type: string
      description: Имя
      example: Иван
      nullable: true
    middle_name:
      type: string
      description: Отчество
      example: Иванович
      nullable: true
    gender:
      type: integer
      description: Пол из CustomerGenderEnum
      example: 1
      nullable: true
    create_by_admin:
      type: boolean
      description: Пользователь создан администратором
      example: false
    city:
      type: string
      description: Город клиента
      example: Москва
      nullable: true
    birthday:
      type: string
      format: date
      description: День рождения
      example: 2020-12-15
      nullable: true
    last_visit_date:
      type: string
      description: Дата последней авторизации
      nullable: true
    comment_status:
      type: string
      description: Коментарий к статусу клиента
      nullable: true
    timezone:
      type: string
      description: Временная зона
      example: Europe/Moscow
    is_deleted:
      type: boolean
      description: Удалены ли данные пользователя
      example: true
    error_delete:
      type: string
      description: Ошибки при удалении персональных данных пользователя
      example: Oms cannot delete customer personal data, order 123
      nullable: true
CustomerFillableRequiredProperties:
  type: object
  required:
    - user_id
    - status_id
    - manager_id
    - yandex_metric_id
    - google_analytics_id
    - email
    - phone
    - last_name
    - first_name
    - middle_name
    - gender
    - create_by_admin
    - city
    - birthday
    - last_visit_date
    - comment_status
    - timezone
  additionalProperties:
    type: string
CustomerIncludes:
  type: object
  properties:
    addresses:
      type: array
      items:
        $ref: ./customer_addresses.yaml#/CustomerAddress
    status:
      allOf:
        - $ref: ./customer_statuses.yaml#/CustomerStatus
    user:
      allOf:
        - $ref: ./users.yaml#/User
Customer:
  allOf:
    - $ref: "#/CustomerReadonlyProperties"
    - $ref: "#/CustomerFillableProperties"
    - $ref: "#/CustomerFillableRequiredProperties"
    - $ref: "#/CustomerIncludes"
CreateCustomerRequest:
  allOf:
    - $ref: "#/CustomerFillableProperties"
    - $ref: "#/CustomerFillableRequiredProperties"
PatchCustomerRequest:
  allOf:
    - $ref: "#/CustomerFillableProperties"
SearchCustomersFilter:
  type: object
  additionalProperties:
    type: string
SearchCustomersRequest:
  type: object
  description: >
    Доступные для сортировки поля: `id, email, phone, first_name, last_name,
    middle_name, birthday, last_visit_date, created_at, updated_at, active`.
  properties:
    sort:
      $ref: ../../common_schemas.yaml#/RequestBodySort
    filter:
      $ref: "#/SearchCustomersFilter"
    include:
      $ref: ../../common_schemas.yaml#/RequestBodyInclude
    pagination:
      $ref: ../../common_schemas.yaml#/RequestBodyPagination
CustomerResponse:
  type: object
  properties:
    data:
      $ref: "#/Customer"
    meta:
      type: object
      properties:
        pagination:
          $ref: ../../common_schemas.yaml#/ResponseBodyPagination
  required:
    - data
SearchCustomersResponse:
  type: object
  properties:
    data:
      type: array
      items:
        $ref: "#/Customer"
    meta:
      type: object
      properties:
        pagination:
          $ref: ../../common_schemas.yaml#/ResponseBodyPagination
  required:
    - data
    - meta
